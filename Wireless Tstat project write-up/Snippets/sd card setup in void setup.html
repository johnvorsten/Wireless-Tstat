<pre>
 &nbsp;<font color="#434f54">&#47;&#47;==============================================================&#47;&#47;</font>
 &nbsp;<font color="#434f54">&#47;&#47;Begin setup for SD Card</font>
 &nbsp;<font color="#00979c">const</font> <font color="#00979c">uint8_t</font> <font color="#000000">BASE_NAME_SIZE</font> <font color="#434f54">=</font> <font color="#00979c">sizeof</font><font color="#000000">(</font><font color="#000000">FILE_BASE_NAME</font><font color="#000000">)</font> <font color="#434f54">-</font> <font color="#000000">1</font><font color="#000000">;</font>
 &nbsp;<font color="#00979c">char</font> <font color="#000000">fileName</font><font color="#000000">[</font><font color="#000000">13</font><font color="#000000">]</font> <font color="#434f54">=</font> <font color="#000000">FILE_BASE_NAME</font> <font color="#005c5f">&#34;00.csv&#34;</font><font color="#000000">;</font>

 &nbsp;<font color="#434f54">&#47;&#47;Begins the communication between the SD card and Arduino</font>
 &nbsp;<font color="#5e6d03">if</font> <font color="#000000">(</font><font color="#434f54">!</font><font color="#000000">sd</font><font color="#434f54">.</font><font color="#d35400">begin</font><font color="#000000">(</font><font color="#000000">chipSelect</font><font color="#434f54">,</font> <font color="#000000">SD_SCK_MHZ</font><font color="#000000">(</font><font color="#000000">50</font><font color="#000000">)</font><font color="#000000">)</font><font color="#000000">)</font> <font color="#000000">{</font> <font color="#434f54">&#47;&#47;send chip select and comm speed</font>
 &nbsp;&nbsp;&nbsp;<font color="#000000">sd</font><font color="#434f54">.</font><font color="#000000">initErrorHalt</font><font color="#000000">(</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;<font color="#000000">}</font>

 &nbsp;<font color="#434f54">&#47;&#47;Fine an unused file name</font>
 &nbsp;<font color="#5e6d03">if</font> <font color="#000000">(</font><font color="#000000">BASE_NAME_SIZE</font> <font color="#434f54">&gt;</font> <font color="#000000">6</font><font color="#000000">)</font> <font color="#000000">{</font>
 &nbsp;&nbsp;&nbsp;<font color="#000000">error</font><font color="#000000">(</font><font color="#005c5f">&#34;FILE_BASE_NAME too long&#34;</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;<font color="#000000">}</font>

 &nbsp;<font color="#434f54">&#47;&#47;Error check the file name in the SD</font>
 &nbsp;<font color="#5e6d03">while</font> <font color="#000000">(</font><font color="#000000">sd</font><font color="#434f54">.</font><font color="#d35400">exists</font><font color="#000000">(</font><font color="#000000">fileName</font><font color="#000000">)</font><font color="#000000">)</font> <font color="#000000">{</font>
 &nbsp;&nbsp;&nbsp;<font color="#5e6d03">if</font> <font color="#000000">(</font><font color="#000000">fileName</font><font color="#000000">[</font><font color="#000000">BASE_NAME_SIZE</font> <font color="#434f54">+</font> <font color="#000000">1</font><font color="#000000">]</font> <font color="#434f54">!=</font> <font color="#00979c">&#39;9&#39;</font><font color="#000000">)</font> <font color="#000000">{</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000000">fileName</font><font color="#000000">[</font><font color="#000000">BASE_NAME_SIZE</font><font color="#000000">]</font><font color="#434f54">++</font><font color="#000000">;</font>
 &nbsp;&nbsp;&nbsp;<font color="#000000">}</font> <font color="#5e6d03">else</font> <font color="#5e6d03">if</font> <font color="#000000">(</font><font color="#000000">fileName</font><font color="#000000">[</font><font color="#000000">BASE_NAME_SIZE</font><font color="#000000">]</font> <font color="#434f54">!=</font> <font color="#00979c">&#39;9&#39;</font><font color="#000000">)</font> <font color="#000000">{</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000000">fileName</font><font color="#000000">[</font><font color="#000000">BASE_NAME_SIZE</font> <font color="#434f54">+</font> <font color="#000000">1</font><font color="#000000">]</font> <font color="#434f54">=</font> <font color="#00979c">&#39;0&#39;</font><font color="#000000">;</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000000">fileName</font><font color="#000000">[</font><font color="#000000">BASE_NAME_SIZE</font><font color="#000000">]</font><font color="#434f54">++</font><font color="#000000">;</font>
 &nbsp;&nbsp;&nbsp;<font color="#000000">}</font> <font color="#5e6d03">else</font> <font color="#000000">{</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000000">error</font><font color="#000000">(</font><font color="#005c5f">&#34;Can&#39;t create file name&#34;</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;&nbsp;&nbsp;<font color="#000000">}</font>
 &nbsp;<font color="#000000">}</font>

 &nbsp;<font color="#434f54">&#47;&#47;Error check if you cant open a file</font>
 &nbsp;<font color="#5e6d03">if</font> <font color="#000000">(</font><font color="#434f54">!</font><font color="#000000">file</font><font color="#434f54">.</font><font color="#d35400">open</font><font color="#000000">(</font><font color="#000000">fileName</font><font color="#434f54">,</font> <font color="#000000">O_CREAT</font> <font color="#434f54">|</font> <font color="#000000">O_WRITE</font> <font color="#434f54">|</font> <font color="#000000">O_EXCL</font><font color="#000000">)</font><font color="#000000">)</font> <font color="#000000">{</font>
 &nbsp;&nbsp;&nbsp;<font color="#000000">error</font><font color="#000000">(</font><font color="#005c5f">&#34;file.open&#34;</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;<font color="#000000">}</font>

 &nbsp;<b><font color="#d35400">Serial</font></b><font color="#434f54">.</font><font color="#d35400">print</font><font color="#000000">(</font><font color="#000000">F</font><font color="#000000">(</font><font color="#005c5f">&#34;Logging to: &#34;</font><font color="#000000">)</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;<b><font color="#d35400">Serial</font></b><font color="#434f54">.</font><font color="#d35400">println</font><font color="#000000">(</font><font color="#000000">fileName</font><font color="#000000">)</font><font color="#000000">;</font>

 &nbsp;<font color="#434f54">&#47;&#47;Write your header data</font>
 &nbsp;<font color="#000000">WriteHeader</font><font color="#000000">(</font><font color="#000000">)</font><font color="#000000">;</font>
<font color="#000000">}</font>

</pre>